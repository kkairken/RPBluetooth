# Configuration for RTSP camera mode
# Offline face access control system for Raspberry Pi 3

# Camera configuration
camera:
  type: rtsp
  rtsp_url: "rtsp://192.168.1.100:554/stream"  # RTSP stream URL
  rtsp_transport: tcp  # tcp or udp
  width: 640
  height: 480
  fps: 15

# Face recognition configuration
face:
  # Path to InsightFace ONNX model
  onnx_model_path: "models/insightface_medium.onnx"

  # Detector type: opencv_haar, mediapipe, or none
  detector_type: opencv_haar
  detector_scale_factor: 1.1
  detector_min_neighbors: 5
  detector_min_face_size: [60, 60]

  # Embedding settings
  embedding_dim: 512
  similarity_threshold: 0.6

  # Quality checks
  quality_min_face_size: 80
  quality_blur_threshold: 100.0
  align_enabled: true

# BLE GATT server configuration
ble:
  device_name: "RP3_FaceAccess"
  service_uuid: "12345678-1234-5678-1234-56789abcdef0"
  command_char_uuid: "12345678-1234-5678-1234-56789abcdef1"
  response_char_uuid: "12345678-1234-5678-1234-56789abcdef2"
  photo_chunk_size: 512
  max_photo_size: 5242880
  hmac_enabled: true
  shared_secret: "change_this_secret_key_in_production"

# Access control settings
access:
  admin_mode_enabled: true
  unlock_duration_sec: 3.0
  cooldown_sec: 0.5  # Reduced from 2.0 for faster recognition
  max_attempts_per_minute: 30  # Increased to allow faster attempts
  granted_lockout_sec: 10.0  # Reduced from 30.0 for faster re-recognition

# Lock GPIO configuration (using libgpiod)
lock:
  gpio_pin: 17          # Pin 11 - управление реле замка
  gpio_chip: "gpiochip0"
  active_high: true     # true = HIGH открывает, false = LOW открывает
  mock_mode: false
  button_pin: 27        # Pin 13 - кнопка выхода (рядом с реле)
  button_active_low: true   # Кнопка замыкает на GND
  button_debounce_ms: 50

# Database configuration
database:
  path: "data/access_control.db"

log_level: INFO
